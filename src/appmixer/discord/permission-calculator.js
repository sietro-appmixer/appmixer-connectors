// Discord's permission bitflags, per docs
// https://discord.com/developers/docs/topics/permissions#permissions-bitwise-permission-flags
const PERMISSIONS = {
    CREATE_INSTANT_INVITE: 1,
    KICK_MEMBERS: 2,
    BAN_MEMBERS: 4,
    ADMINISTRATOR: 8,
    MANAGE_CHANNELS: 16,
    MANAGE_GUILD: 32,
    ADD_REACTIONS: 64,
    VIEW_AUDIT_LOG: 128,
    PRIORITY_SPEAKER: 256,
    STREAM: 512,
    VIEW_CHANNEL: 1024,
    SEND_MESSAGES: 2048,
    SEND_TTS_MESSAGES: 4096,
    MANAGE_MESSAGES: 8192,
    EMBED_LINKS: 16384,
    ATTACH_FILES: 32768,
    READ_MESSAGE_HISTORY: 65536,
    MENTION_EVERYONE: 131072,
    USE_EXTERNAL_EMOJIS: 262144,
    VIEW_GUILD_INSIGHTS: 524288,
    CONNECT: 1048576,
    SPEAK: 2097152,
    MUTE_MEMBERS: 4194304,
    DEAFEN_MEMBERS: 8388608,
    MOVE_MEMBERS: 16777216,
    USE_VAD: 33554432,
    CHANGE_NICKNAME: 67108864,
    MANAGE_NICKNAMES: 134217728,
    MANAGE_ROLES: 268435456,
    MANAGE_WEBHOOKS: 536870912,
    MANAGE_EMOJIS_AND_STICKERS: 1073741824,
    USE_APPLICATION_COMMANDS: 2147483648,
    REQUEST_TO_SPEAK: 4294967296,
    MANAGE_EVENTS: 8589934592,
    MANAGE_THREADS: 17179869184,
    CREATE_PUBLIC_THREADS: 34359738368,
    CREATE_PRIVATE_THREADS: 68719476736,
    USE_EXTERNAL_STICKERS: 137438953472,
    SEND_MESSAGES_IN_THREADS: 274877906944,
    USE_EMBEDDED_ACTIVITIES: 549755813888,
    MODERATE_MEMBERS: 1099511627776,
    VIEW_CREATOR_MONETIZATION_ANALYTICS: 2199023255552,
    USE_SOUNDBOARD: 4398046511104,
    CREATE_GUILD_EXPRESSIONS: 8796093022208,
    CREATE_EVENTS: 17592186044416
};

function splitScopesAndPermissions(arr) {
    const permissionsFlags = Object.keys(PERMISSIONS);
    let permissionsBitfield = 0;
    const scopes = [];

    arr.forEach(item => {
        if (permissionsFlags.includes(item)) {
            permissionsBitfield += PERMISSIONS[item];
        } else {
            scopes.push(item);
        }
    });

    return {
        permissions: permissionsBitfield,
        scopes
    };
}

module.exports = {
    splitScopesAndPermissions
};
