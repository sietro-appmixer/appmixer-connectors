[
    {
        "role": "user",
        "content": "# Square Connector Context\n\n## Service Overview\nSquare is a comprehensive financial services platform that provides payment processing, point-of-sale systems, and business management tools. The platform serves businesses of all sizes with tools for accepting payments, managing customers, tracking inventory, processing orders, and handling various business operations.\n\n## API Documentation\n- Main API Reference: https://developer.squareup.com/reference/square\n- OAuth Documentation: https://developer.squareup.com/docs/oauth-api/overview\n- API Base URLs:\n  - Production: https://connect.squareup.com/\n  - Sandbox: https://connect.squareupsandbox.com/\n\n## Authentication Method\nSquare uses **OAuth 2.0** for authentication with two supported flows:\n\n### 1. OAuth Code Flow (Recommended for server applications)\n- Uses `client_id` and `client_secret`\n- For confidential client applications that run on a server\n- Refresh tokens don't expire (until revoked)\n- Requires HTTPS redirect URLs (localhost allowed for testing)\n\n### 2. OAuth PKCE Flow (For public clients)\n- Uses `client_id` and `code_verifier` (no client_secret)\n- For mobile apps, single-page apps, and native desktop applications\n- Refresh tokens are single-use and expire after 90 days\n\n### OAuth Process\n1. **Authorization**: Direct seller to Square authorization page with requested permissions\n2. **Callback**: Square redirects back with authorization code\n3. **Token Exchange**: Exchange authorization code for access token and refresh token\n\n### Key Details\n- Access tokens expire after 30 days\n- Authorization codes expire after 5 minutes\n- Requires specific OAuth scopes/permissions\n- Supports webhook notifications for token revocation\n\n### How to Obtain Credentials\n1. Visit the Square Developer Console: https://developer.squareup.com/apps\n2. Create a new application or use an existing one\n3. Note the Application ID (client_id) and Application Secret (client_secret)\n4. Configure redirect URLs for OAuth flow\n5. Set appropriate OAuth permissions/scopes\n\n## Proposed Components\n\nBased on the Square API documentation and comprehensive analysis of popular Square integrations, the connector should implement the following essential components:\n\n### Core Business Operations\n\n#### 1. **ListLocations**\n- **Description**: Retrieve all business locations for a Square account\n- **API Endpoint**: GET /v2/locations\n- **Purpose**: Foundation component for location-based operations\n\n### Customer Management\n\n#### 2. **ListCustomers**\n- **Description**: Retrieve customer profiles with filtering and pagination\n- **API Endpoint**: GET /v2/customers\n- **Purpose**: Access customer database for CRM integration\n\n#### 3. **CreateCustomer**\n- **Description**: Create a new customer profile\n- **API Endpoint**: POST /v2/customers\n- **Purpose**: Add new customers to the Square system\n\n#### 4. **GetCustomer**\n- **Description**: Get detailed information for a specific customer\n- **API Endpoint**: GET /v2/customers/{customer_id}\n- **Purpose**: Access individual customer details and history\n\n#### 5. **FindCustomer**\n- **Description**: Find a customer based on email, phone number, or reference ID\n- **API Endpoint**: POST /v2/customers/search\n- **Purpose**: Search for existing customers using various identifiers\n\n#### 6. **UpdateCustomer**\n- **Description**: Update existing customer information\n- **API Endpoint**: PUT /v2/customers/{customer_id}\n- **Purpose**: Maintain accurate customer records\n\n### Payment Processing\n\n#### 7. **ListPayments**\n- **Description**: Retrieve payment transactions with filtering\n- **API Endpoint**: GET /v2/payments\n- **Purpose**: Access payment history and transaction data\n\n#### 8. **CreatePayment**\n- **Description**: Process a new payment transaction\n- **API Endpoint**: POST /v2/payments\n- **Purpose**: Accept payments through the API\n\n#### 9. **GetPayment**\n- **Description**: Get details for a specific payment\n- **API Endpoint**: GET /v2/payments/{payment_id}\n- **Purpose**: Access individual payment transaction details\n\n#### 10. **RefundPayment**\n- **Description**: Create a refund for a completed payment\n- **API Endpoint**: POST /v2/refunds\n- **Purpose**: Process payment refunds for customer satisfaction\n\n### Order Management\n\n#### 11. **CreateOrder**\n- **Description**: Create a new order with line items\n- **API Endpoint**: POST /v2/orders\n- **Purpose**: Create itemized orders for payment processing\n\n#### 12. **SearchOrders**\n- **Description**: Search orders across locations with filtering\n- **API Endpoint**: POST /v2/orders/search\n- **Purpose**: Find orders based on various criteria\n\n#### 13. **GetOrder**\n- **Description**: Get details for a specific order\n- **API Endpoint**: GET /v2/orders/{order_id}\n- **Purpose**: Access individual order information\n\n#### 14. **UpdateOrder**\n- **Description**: Update an existing order\n- **API Endpoint**: PUT /v2/orders/{order_id}\n- **Purpose**: Modify order details before fulfillment\n\n### Catalog Management\n\n#### 15. **ListCatalogObjects**\n- **Description**: Retrieve catalog items (products, services, variations)\n- **API Endpoint**: GET /v2/catalog/list\n- **Purpose**: Access product and service catalog\n\n#### 16. **GetCatalogObject**\n- **Description**: Get details for a specific catalog item\n- **API Endpoint**: GET /v2/catalog/object/{object_id}\n- **Purpose**: Access individual product/service details\n\n#### 17. **SearchCatalogObjects**\n- **Description**: Search catalog items with filtering\n- **API Endpoint**: POST /v2/catalog/search\n- **Purpose**: Find products/services based on various criteria\n\n### Inventory Management\n\n#### 18. **GetInventoryCount**\n- **Description**: Get current inventory levels for catalog items\n- **API Endpoint**: GET /v2/inventory/{catalog_object_id}\n- **Purpose**: Track product inventory levels\n\n#### 19. **ChangeInventory**\n- **Description**: Adjust inventory or change physical count\n- **API Endpoint**: POST /v2/inventory/changes/batch-create\n- **Purpose**: Update inventory levels for stock management\n\n### Advanced Components\n\n#### 20. **CreateWebhookSubscription**\n- **Description**: Subscribe to Square webhook events\n- **API Endpoint**: POST /v2/webhooks/subscriptions\n- **Purpose**: Set up real-time event notifications\n\n#### 21. **ApiRequest**\n- **Description**: Make custom API requests to Square endpoints\n- **API Endpoint**: Any Square API endpoint\n- **Purpose**: Provide flexibility for advanced use cases and custom integrations\n\n## API Features and Capabilities\n\n### Supported Operations\n- **Payments**: Accept, process, refund, and track payments\n- **Orders**: Create, update, search, and fulfill orders\n- **Customers**: Manage customer profiles and relationships\n- **Catalog**: Manage products, services, and pricing\n- **Inventory**: Track stock levels and changes\n- **Locations**: Manage multiple business locations\n- **Webhooks**: Real-time event notifications\n\n### Key Benefits\n- Comprehensive payment processing\n- Multi-location support\n- Rich customer management\n- Detailed transaction reporting\n- Real-time inventory tracking\n- Flexible order management\n- Extensive webhook events\n\n### Rate Limits and Quotas\n- API calls are subject to rate limiting\n- Different endpoints may have different limits\n- Should implement proper quota management in connector\n\n## Notes for Implementation\n1. **OAuth Implementation**: Use OAuth 2.0 Code flow for server-side applications\n2. **Error Handling**: Implement proper error handling for API responses\n3. **Pagination**: Many list endpoints support pagination - implement accordingly\n4. **Webhooks**: Consider implementing webhook components for real-time updates\n5. **Environments**: Support both Sandbox (testing) and Production environments\n6. **Permissions**: Request only necessary OAuth scopes for required functionality\n7. **Rate Limiting**: Implement appropriate quotas to respect API limits\n\n## Priority Implementation Order\n1. **Authentication Setup** (OAuth 2.0)\n2. **Core Business** (ListLocations)  \n3. **Customer Management** (ListCustomers, CreateCustomer, GetCustomer, FindCustomer, UpdateCustomer)\n4. **Payment Processing** (ListPayments, CreatePayment, GetPayment, RefundPayment)\n5. **Order Management** (CreateOrder, SearchOrders, GetOrder, UpdateOrder)\n6. **Catalog Management** (ListCatalogObjects, GetCatalogObject, SearchCatalogObjects)\n7. **Inventory Management** (GetInventoryCount, ChangeInventory)\n8. **Advanced Features** (CreateWebhookSubscription, ApiRequest)"
    },
    {
        "role": "system",
        "content": "I am planning to build an integration component for square. Could you provide me with a list and description of the most commonly used and essential API endpoints for this service? Specifically, I am interested in endpoints related to core operations. For each endpoint, please include the HTTP method (GET, POST, PUT, PATCH, DELETE), the endpoint URL or path, link to documentation, a brief description of its purpose, provide list of inputs. If possible, also mention any authentication requirements."
    },
    {
        "role": "user",
        "content": "Create the service json as well, (serviceJson property)"
    },
    {
        "role": "user",
        "content": "ignore input parameters for pagination, it could be for example page, offset, limit, etc."
    },
    {
        "role": "user",
        "content": "Action naming conventions: Try to avoid naming with \"List\", such as \"List Users\", \"List Contacts\" etc. Use \"Find\" instead. For example \"Find Users\", \"FInd Contacts\". These actions have usually input parameters for search, such as \"query\", \"search\" or similar."
    },
    {
        "role": "user",
        "content": "Provide information about authentication, include type of authentication, and other properties. Provide information about authentication endpoint URL, token URL for managing access token - for obtaining access token and refreshing access token. Provide information about profile info URL, where is possible to get information about current user. It is used for getting user profile information, such as email, name, etc. (authentication property)"
    },
    {
        "role": "assistant",
        "content": "{\n  \"actions\": [\n    {\n      \"title\": \"Find Locations\",\n      \"description\": \"Retrieve all business locations for a Square account.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/locations-api\",\n      \"endpointUrl\": \"/v2/locations\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"GET\",\n      \"sampleResponse\": {\n        \"locations\": [\n          {\n            \"id\": \"LOCATION_ID\",\n            \"name\": \"Test Location\"\n          }\n        ]\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"No additional inputs required.\",\n        \"properties\": {}\n      },\n      \"outputType\": {\n        \"outputType\": \"array\",\n        \"arrayPropertyValue\": \"locations\"\n      }\n    },\n    {\n      \"title\": \"Find Customers\",\n      \"description\": \"Retrieve a list of customer profiles. Use an optional query parameter to filter customers.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/customers-api\",\n      \"endpointUrl\": \"/v2/customers\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"GET\",\n      \"sampleResponse\": {\n        \"customers\": [\n          {\n            \"id\": \"CUSTOMER_ID\",\n            \"given_name\": \"John\",\n            \"family_name\": \"Doe\"\n          }\n        ]\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Optional search query to filter customer results.\",\n        \"properties\": {\n          \"query\": {\n            \"type\": \"string\",\n            \"description\": \"Search string to filter customers by name, email, etc.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"array\",\n        \"arrayPropertyValue\": \"customers\"\n      }\n    },\n    {\n      \"title\": \"Create Customer\",\n      \"description\": \"Create a new customer profile in Square.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/customers-api/create-customer\",\n      \"endpointUrl\": \"/v2/customers\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"POST\",\n      \"sampleResponse\": {\n        \"customer\": {\n          \"id\": \"CUSTOMER_ID\",\n          \"given_name\": \"John\",\n          \"family_name\": \"Doe\"\n        }\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Customer details required for creation.\",\n        \"properties\": {\n          \"given_name\": {\n            \"type\": \"string\",\n            \"description\": \"The first name of the customer.\"\n          },\n          \"family_name\": {\n            \"type\": \"string\",\n            \"description\": \"The last name of the customer.\"\n          },\n          \"email_address\": {\n            \"type\": \"string\",\n            \"description\": \"The email address of the customer.\"\n          },\n          \"phone_number\": {\n            \"type\": \"string\",\n            \"description\": \"The phone number of the customer.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"object\"\n      }\n    },\n    {\n      \"title\": \"Get Customer\",\n      \"description\": \"Retrieve detailed information for a specific customer by their ID.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/customers-api/retrieve-customer\",\n      \"endpointUrl\": \"/v2/customers/{customer_id}\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"GET\",\n      \"sampleResponse\": {\n        \"customer\": {\n          \"id\": \"CUSTOMER_ID\",\n          \"given_name\": \"John\",\n          \"family_name\": \"Doe\",\n          \"email_address\": \"john.doe@example.com\"\n        }\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Customer ID is required to retrieve details.\",\n        \"properties\": {\n          \"customer_id\": {\n            \"type\": \"string\",\n            \"description\": \"The unique identifier for the customer.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"object\"\n      }\n    },\n    {\n      \"title\": \"Search Customer\",\n      \"description\": \"Search for a customer using email, phone number, or reference ID.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/customers-api/search-customers\",\n      \"endpointUrl\": \"/v2/customers/search\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"POST\",\n      \"sampleResponse\": {\n        \"customers\": [\n          {\n            \"id\": \"CUSTOMER_ID\",\n            \"given_name\": \"John\",\n            \"family_name\": \"Doe\"\n          }\n        ]\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Search criteria to locate a customer.\",\n        \"properties\": {\n          \"query\": {\n            \"type\": \"string\",\n            \"description\": \"The search term (such as email, phone number, or reference ID) used to find the customer.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"array\",\n        \"arrayPropertyValue\": \"customers\"\n      }\n    },\n    {\n      \"title\": \"Update Customer\",\n      \"description\": \"Update the profile information of an existing customer.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/customers-api/update-customer\",\n      \"endpointUrl\": \"/v2/customers/{customer_id}\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"PUT\",\n      \"sampleResponse\": {\n        \"customer\": {\n          \"id\": \"CUSTOMER_ID\",\n          \"given_name\": \"Jane\",\n          \"family_name\": \"Doe\"\n        }\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Provide the customer ID and updated details.\",\n        \"properties\": {\n          \"customer_id\": {\n            \"type\": \"string\",\n            \"description\": \"The unique identifier for the customer.\"\n          },\n          \"given_name\": {\n            \"type\": \"string\",\n            \"description\": \"Updated given name of the customer.\"\n          },\n          \"family_name\": {\n            \"type\": \"string\",\n            \"description\": \"Updated family name of the customer.\"\n          },\n          \"email_address\": {\n            \"type\": \"string\",\n            \"description\": \"Updated email address of the customer.\"\n          },\n          \"phone_number\": {\n            \"type\": \"string\",\n            \"description\": \"Updated phone number of the customer.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"object\"\n      }\n    },\n    {\n      \"title\": \"Find Payments\",\n      \"description\": \"Retrieve payment transactions. Optionally filter payments using a search query.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/payments-api\",\n      \"endpointUrl\": \"/v2/payments\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"GET\",\n      \"sampleResponse\": {\n        \"payments\": [\n          {\n            \"id\": \"PAYMENT_ID\",\n            \"amount\": 1000,\n            \"status\": \"COMPLETED\"\n          }\n        ]\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Optional criteria to filter the payment transactions.\",\n        \"properties\": {\n          \"query\": {\n            \"type\": \"string\",\n            \"description\": \"Search query to filter payments.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"array\",\n        \"arrayPropertyValue\": \"payments\"\n      }\n    },\n    {\n      \"title\": \"Create Payment\",\n      \"description\": \"Process a new payment transaction.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/payments-api/create-payment\",\n      \"endpointUrl\": \"/v2/payments\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"POST\",\n      \"sampleResponse\": {\n        \"payment\": {\n          \"id\": \"PAYMENT_ID\",\n          \"amount\": 1000,\n          \"status\": \"PENDING\"\n        }\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Details of the payment to process.\",\n        \"properties\": {\n          \"amount\": {\n            \"type\": \"number\",\n            \"description\": \"The payment amount in the smallest unit of the currency (e.g., cents).\"\n          },\n          \"currency\": {\n            \"type\": \"string\",\n            \"description\": \"Currency code in ISO 4217 format (e.g., USD).\"\n          },\n          \"source_id\": {\n            \"type\": \"string\",\n            \"description\": \"A valid identifier for the source of funding for the payment (e.g., a card nonce).\"\n          },\n          \"customer_id\": {\n            \"type\": \"string\",\n            \"description\": \"The ID of the customer associated with the payment.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"object\"\n      }\n    },\n    {\n      \"title\": \"Get Payment\",\n      \"description\": \"Retrieve detailed information about a specific payment using its ID.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/payments-api/retrieve-payment\",\n      \"endpointUrl\": \"/v2/payments/{payment_id}\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"GET\",\n      \"sampleResponse\": {\n        \"payment\": {\n          \"id\": \"PAYMENT_ID\",\n          \"amount\": 1000,\n          \"status\": \"COMPLETED\"\n        }\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Payment ID is required to retrieve payment details.\",\n        \"properties\": {\n          \"payment_id\": {\n            \"type\": \"string\",\n            \"description\": \"The unique identifier for the payment.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"object\"\n      }\n    },\n    {\n      \"title\": \"Refund Payment\",\n      \"description\": \"Initiate a refund for a completed payment.\",\n      \"type\": \"action\",\n      \"documentation\": \"https://developer.squareup.com/reference/square/refunds-api/refund-payment\",\n      \"endpointUrl\": \"/v2/refunds\",\n      \"apiBaseUrl\": \"https://connect.squareup.com/\",\n      \"method\": \"POST\",\n      \"sampleResponse\": {\n        \"refund\": {\n          \"id\": \"REFUND_ID\",\n          \"status\": \"PENDING\"\n        }\n      },\n      \"inputSchema\": {\n        \"type\": \"object\",\n        \"description\": \"Provide details required to process a refund.\",\n        \"properties\": {\n          \"payment_id\": {\n            \"type\": \"string\",\n            \"description\": \"The ID of the payment to refund.\"\n          },\n          \"amount\": {\n            \"type\": \"number\",\n            \"description\": \"The amount to refund in the smallest currency unit.\"\n          },\n          \"reason\": {\n            \"type\": \"string\",\n            \"description\": \"Optional reason for the refund.\"\n          }\n        }\n      },\n      \"outputType\": {\n        \"outputType\": \"object\"\n      }\n    }\n  ],\n  \"authentication\": {\n    \"type\": \"oauth2\",\n    \"authUrl\": \"https://connect.squareup.com/oauth2/authorize\",\n    \"tokenUrl\": \"https://connect.squareup.com/oauth2/token\",\n    \"profileInfoUrl\": \"https://connect.squareup.com/v2/merchants/me\"\n  },\n  \"serviceJson\": {\n    \"name\": \"square.connector\",\n    \"label\": \"Square Connector\",\n    \"category\": \"applications\",\n    \"description\": \"Integration component for Square API focusing on core business operations such as managing locations, customers, and payments.\",\n    \"version\": \"1.0.0\",\n    \"icon\": \"https://developer.squareup.com/favicon.ico\"\n  }\n}"
    }
]